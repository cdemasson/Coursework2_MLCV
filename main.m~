%% creation of the boat and tsukuba dataset
clear all;

for FIG = 1:6
    boat(FIG).fig = imread(['img' num2str(FIG) '.pgm']);
end

for FIG = 1:5
    tsukuba(FIG).fig = imread(['scene1.row3.col' num2str(FIG) '.ppm']);
end

%% Collecting 5 matching coordinates from two boat images
% David Has edited this code for Q3 

% In the boat sequence, let's click on 10 identical points on the 2
% pictures
Bc = zeros(2,2,5);      %Boat coordinates
Pictures = [1,2]; 
for PT= 1:5
    for FIG = Pictures
        figure(FIG);
        imshow(boat(FIG).fig);
        [Bc(1, FIG, PT), Bc(2, FIG, PT)] = ginput(1);
    end
end

%% David's work starts here
% Finding the homogenous matrix using SVD 
% This will be done using 10 matched points on the two images 

%Building the A matrix, by vertically concatenating the 10 equations from
%the 5 different corrosponding points

A = [];     %Initialise the matrix
for Pt = 1 : length(Bc) 
    Ax = [-Bc(1,1,Pt),-Bc(2,1,Pt),-1,0,0,0,Bc(1,2,Pt)*Bc(1,1,Pt),Bc(1,2,Pt)*Bc(2,1,Pt),Bc(1,2,Pt)];
    Ay = [0,0,0,-Bc(1,1,Pt),-Bc(2,1,Pt),-1,Bc(2,2,Pt)*Bc(1,1,Pt),Bc(2,2,Pt)*Bc(2,1,Pt),Bc(2,2,Pt)];
    A = [A;Ax;Ay]; 
end 

%A = A.'*A;
%Compute the singular value decomposition
[U,S,V] = svd(A);
h = V(:,9)/V(9,9); 
h = [V(1,1:3);V(1,4:6);V(1,7:9)]



















